$(document).ready(function(){$(".header__burger").click(function(){$(this).hasClass("active")?($(this).removeClass("active"),$(".header-mobile").removeClass("active"),$("body").removeClass("ov-hid")):($(".header__burger").addClass("active"),$(".header-mobile").addClass("active"),$("body").addClass("ov-hid"))})}),$(document).ready(function(){$(".header__search").click(function(){$(".header__search-box").hasClass("active")?($(".header__search-box").removeClass("active"),$(".header-search").removeClass("active")):($(".header__search-box").addClass("active"),$(".header-search").addClass("active"))})}),$(document).ready(function(){new Swiper(".slider .swiper-container",{loop:!0,slidesPerView:1,slidesPerGroup:1,spaceBetween:15,centeredSlides:!0,autoHeight:!0,grabCursor:!0,watchSlidesProgress:!0,watchSlidesVisibility:!0,resizeObserver:!0,navigation:{nextEl:".slider .swiper-button-next",prevEl:".slider .swiper-button-prev"},breakpoints:{768:{slidesPerView:"auto",spaceBetween:0},1200:{slidesPerView:"auto",spaceBetween:0}}})}),$(document).ready(function(){new Swiper(".underintro__slider .swiper-container",{loop:!1,slidesPerView:1,slidesPerGroup:1,spaceBetween:30,centeredSlides:!0,autoHeight:!0,grabCursor:!0,watchSlidesProgress:!0,watchSlidesVisibility:!0,navigation:{nextEl:".underintro__slider .swiper-button-next",prevEl:".underintro__slider .swiper-button-prev"}})}),$(document).ready(function(){$.datepicker.regional.ru={closeText:"Закрыть",prevText:"<",nextText:">",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Нед",dateFormat:"dd.mm.yy",firstDay:1,minDate:null,isRTL:!1,showMonthAfterYear:!1,showButtonPanel:!0,yearSuffix:"",changeYear:!0,changeMonth:!0},$.datepicker.setDefaults($.datepicker.regional.ru),$(".input-datepicker").datepicker($.datepicker.regional.ru),$("#person_search_form_birthDate").datepicker("option","yearRange","1933:2003"),$("#person_search_form_birthDate").datepicker("option","minDate",new Date(1933,-1,1)),$("#person_search_form_birthDate").datepicker("option","maxDate","-18y"),$("#person_search_form_deathDate").datepicker("option","yearRange","1990:2021"),$("#person_search_form_deathDate").datepicker("option","minDate",new Date(1990,-1,1)),$("#person_search_form_deathDate").datepicker("option","maxDate","+0d"),$("#event_search_form_date").datepicker("option","yearRange","1990:2021"),$("#event_search_form_date").datepicker("option","minDate",new Date(1990,-1,1)),$("#event_search_form_date").datepicker("option","maxDate","+0d"),$("#place_search_form_openDate").datepicker("option","yearRange","1974:2021"),$("#place_search_form_openDate").datepicker("option","minDate",new Date(1974,-1,1)),$("#place_search_form_openDate").datepicker("option","maxDate","+0d"),$(".input-datepicker").datepicker().datepicker("setDate"),$('.search__form button[type="reset"]').click(function(){$("#person_search_form_birthDate").attr("value",""),$("#person_search_form_deathDate").attr("value",""),$("#place_search_form_openDate").attr("value",""),$("#person_search_form_text").attr("value",""),$("#person_search_form_birthPlace").attr("value",""),$("#event_search_form_name").attr("value",""),$("#event_search_form_date").attr("value",""),$("#event_search_form_place").attr("value","")}),!1!==$("#person_search_form_birthDate").attr("value")&&$("#person_search_form_birthDate").datepicker().datepicker("setDate",$("#person_search_form_birthDate").attr("value")),!1!==$("#person_search_form_deathDate").attr("value")&&$("#person_search_form_deathDate").datepicker().datepicker("setDate",$("#person_search_form_deathDate").attr("value")),!1!==$("#place_search_form_openDate").attr("value")&&$("#place_search_form_openDate").datepicker().datepicker("setDate",$("#place_search_form_openDate").attr("value")),!1!==$("#event_search_form_date").attr("value")&&$("#event_search_form_date").datepicker().datepicker("setDate",$("#event_search_form_date").attr("value"))}),$(document).ready(function(){$(".select").each(function(){var t=$(this),a=$(this).children("option").length;t.addClass("select"),t.wrap('<div class="select-custom"></div>'),t.after('<div class="select-styled"></div>');var i=t.next("div.select-styled");i.text(t.children("option").eq(0).text());for(var o=$("<ul />",{class:"select-options"}).insertAfter(i),e=0;e<a;e++)$("<li />",{html:"<span>"+t.children("option").eq(e).text()+"</span>",rel:t.children("option").eq(e).val(),title:t.children("option").eq(e).val()}).appendTo(o);var r=o.children("li");i.click(function(e){e.stopPropagation(),$("div.select-styled.active").not(this).each(function(){$(this).removeClass("active").next("ul.select-options").hide()}),$(this).toggleClass("active").next("ul.select-options").toggle()}),r.click(function(e){e.stopPropagation(),i.html('<span class="select-value">'+$(this).text()+"</span>").removeClass("active"),i.attr("rel",$(this).attr("rel")),i.attr("title",$(this).attr("title")),t.val($(this).attr("rel")),t.val($(this).attr("title")),o.hide(),t.trigger("changed")}),$(document).click(function(){i.removeClass("active"),o.hide()}),$('.search__form button[type="reset"]').click(function(){i.html("<span>"+t.children("option").eq(0).text()+"</span>"),i.removeAttr("rel"),i.removeAttr("title");for(var e=0;e<a;e++)t.children("option").eq(e).removeAttr("selected")});for(var n=0;n<a;n++)t.children("option").eq(n).attr("selected")&&(i.html("<span>"+t.children("option").eq(n).text()+"</span>"),i.attr("rel",t.children("option").eq(n).val()),i.attr("title",t.children("option").eq(n).val()))})}),$(document).ready(function(){$(".search__show").click(function(){$(this).parent().prev().addClass("active")}),$(".search__hide").click(function(){$(this).parent().parent().removeClass("active")})}),$(document).ready(function(){$(".article__link").click(function(){var e;$(this).parent().hasClass("active")?($(this).text("Показать подробнее"),$(this).parent().removeClass("active"),e=$(this).parent().offset().top-60,$("body,html").animate({scrollTop:e},2e3),console.log(e)):($(this).text("Скрыть текст"),$(this).parent().addClass("active"))})}),$(document).ready(function(){$(".underintro__description-more").click(function(){var e;$(this).parent().hasClass("active")?($(this).text("Показать подробнее"),$(this).parent().removeClass("active"),e=$(this).parent().offset().top-60,$("body,html").animate({scrollTop:e},2e3),console.log(e)):($(this).text("Скрыть текст"),$(this).parent().addClass("active"))})}),$(document).ready(function(){$(".underintro__text-more").click(function(){var e;$(this).parent().hasClass("active")?($(this).text("Показать подробнее"),$(this).parent().removeClass("active"),e=$(this).parent().offset().top-60,$("body,html").animate({scrollTop:e},2e3),console.log(e)):($(this).text("Скрыть текст"),$(this).parent().addClass("active"))})}),$(document).ready(function(){}),$(document).ready(function(){$(".footer .btn").click(function(){$("#addHero").addClass("show"),$("body").addClass("ov-hid")}),$(".footer__feedback").click(function(){$("#feedback").addClass("show"),$("body").addClass("ov-hid")}),$(".popup-close").click(function(){$(this).parent().parent().removeClass("show"),$("body").removeClass("ov-hid")})}),$(document).mouseup(function(e){var t=$(".popup__wrapper");t.is(e.target)||0!==t.has(e.target).length||(t.parent(e).removeClass("show"),$("body").removeClass("ov-hid"))}),Dropzone.autoDiscover=!1,$(document).ready(function(){$("#photoDropzone").dropzone({url:"/file/post",autoProcessQueue:!1,uploadMultiple:!0,addRemoveLinks:!0,maxFilesize:3,parallelUploads:20,maxFiles:20,acceptedFiles:".png, .jpg, .jpeg",dictRemoveFile:"Удалить",init:function(){this.on("error",function(e){$(e.previewElement).remove(),this.removeFile(e)}),this.on("maxfilesexceeded",function(e){this.removeAllFiles(),this.addFile(e)})}})}),$(document).ready(function(){var s,i;s=void 0!==$("<input/>")[0].multiple,i=/msie/i.test(navigator.userAgent),$.fn.customFile=function(){return this.each(function(){var r=$(this).addClass("custom-file-upload-hidden"),e=$('<div class="file-upload-wrapper">'),n=$('<div class="file-upload-input"></div>'),t=$('<button type="button" class="btn btn-gold file-upload-button">Добавить фото</button>'),a=$('<label class="file-upload-button" for="'+r[0].id+'">Добавить фото</label>');r.css({position:"absolute"}),e.insertAfter(r).append(r,n,i?a:t),r.attr("tabIndex",-1),t.attr("tabIndex",-1),t.click(function(){r.focus().click()}),r.change(function(){var e,t=[];if(s){for(var a,i=0,o=(a=r[0].files).length;i<o;i++)t.push(a[i].name);e=t.join(", ")}else e=r.val().split("\\").pop();n.text(e).attr("title",e).focus()}),n.on({blur:function(){r.trigger("blur")},keydown:function(e){if(13===e.which)i||r.trigger("click");else if(8===e.which||46===e.which)r.replaceWith(r=r.clone(!0)),r.trigger("change"),n.val("");else if(9!==e.which)return!1}})})},s||$(document).on("change","input.customfile",function(){var e=$(this),t="customfile_"+(new Date).getTime(),a=e.parent(),i=a.siblings().find(".file-upload-input").filter(function(){return!this.value}),o=$('<input type="file" id="'+t+'" name="'+e.attr("name")+'"/>');setTimeout(function(){e.val()?i.length||(a.after(o),o.customFile()):(i.parent().remove(),a.appendTo(a.parent()),a.find("input").focus())},1)}),$("input[type=file]").customFile()}),$(document).ready(function(){$(".input").on("keydown",function(e){})}),$(function(){$("input").is(".phone")&&$(".phone").mask("+7 (999) 999-99-99")}),$(document).ready(function(){mapboxgl.accessToken="pk.eyJ1Ijoicm9tYXZlcm5lIiwiYSI6ImNqdHRzZGlkajA3YmE0NHF5aWR5bzM0MDMifQ.RIrCtXnxBaev-IbOSLqn4g";var o=new mapboxgl.Map({container:"map-detail",style:"mapbox://styles/romaverne/cknzx345m0ms617kdkhu5kckc",center:[32.0301,54.4926],zoom:10});o.on("load",function(){o.addSource("places",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{name:"circle-01",description:'<div class="tooltip-event__img">\n                <img src="./img/e-photo-01.jpg" alt="">\n              </div>\n              <div class="tooltip-event__info">\n                <div class="tooltip-event__date">10 апреля 2010 года</div>\n                <div class="tooltip-event__caption">Авиакатастрофа Смоленск</div>\n                <div class="tooltip-event__description">Погибли все находившиеся на его борту 96 человек — 88 пассажиров и 8 членов экипажа в их числе президент Польши Лех Качиньский и его жена Мария Качиньская.</div>\n              </div>'},geometry:{type:"Point",coordinates:[32.0301,54.4926]}}]}}),o.addLayer({id:"places",type:"circle",source:"places",paint:{"circle-color":"#fff","circle-radius":8,"circle-stroke-width":8,"circle-stroke-color":"#E1C989"}}),o.addLayer({id:"places-hover",type:"circle",source:"places",paint:{"circle-color":"#fff","circle-radius":8,"circle-stroke-width":8,"circle-stroke-color":"#1A5D99"},filter:["==","name",""]});var e=new mapboxgl.NavigationControl({showCompass:!1,showZoom:!0});o.addControl(e,"top-right");var i=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});o.on("mouseenter","places",function(e){o.getCanvas().style.cursor="pointer",o.setFilter("places-hover",["==","name",e.features[0].properties.name]);for(var t=e.features[0].geometry.coordinates.slice(),a=e.features[0].properties.description;180<Math.abs(e.lngLat.lng-t[0]);)t[0]+=e.lngLat.lng>t[0]?360:-360;i.setLngLat(t).setHTML(a).addTo(o)}),o.on("mouseleave","places",function(){o.getCanvas().style.cursor="",o.setFilter("places-hover",["==","name",""]),i.remove()})})}),$(document).ready(function(){mapboxgl.accessToken="pk.eyJ1Ijoicm9tYXZlcm5lIiwiYSI6ImNqdHRzZGlkajA3YmE0NHF5aWR5bzM0MDMifQ.RIrCtXnxBaev-IbOSLqn4g";var y=new mapboxgl.Map({container:"map-all",style:"mapbox://styles/romaverne/cknzx345m0ms617kdkhu5kckc",zoom:10});y.on("load",function(){y.addSource("places",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{name:"circle-01",description:'<div class="tooltip-event__img">\n  <img src="./img/e-photo-01.jpg" alt="">\n</div>\n<div class="tooltip-event__info">\n  <div class="tooltip-event__date">1-3 сентября 2004 года</div>\n  <div class="tooltip-event__caption">Террористический акт в Беслане</div>\n  <div class="tooltip-event__description">Во время захвата школы №1, погибло 333 человека, среди них 2 спасателя МЧС России, 1 сотрудник МВД, 6 гражданских спасателей и 10 сотрудников ЦСН ФСБ</div>\n</div>'},geometry:{type:"Point",coordinates:[43.1103,44.3227]}},{type:"Feature",properties:{name:"circle-02",description:'<div class="tooltip-event__img">\n  <img src="./img/e-photo-01.jpg" alt="">\n</div>\n<div class="tooltip-event__info">\n  <div class="tooltip-event__date">10 апреля 2010 года</div>\n  <div class="tooltip-event__caption">Авиакатастрофа Смоленск</div>\n  <div class="tooltip-event__description">Погибли все находившиеся на его борту 96 человек — 88 пассажиров и 8 членов экипажа в их числе президент Польши Лех Качиньский и его жена Мария Качиньская.</div>\n</div>'},geometry:{type:"Point",coordinates:[32.0301,54.4926]}}]}}),y.addLayer({id:"places",type:"circle",source:"places",paint:{"circle-color":"#fff","circle-radius":8,"circle-stroke-width":8,"circle-stroke-color":"#E1C989"}}),y.addLayer({id:"places-hover",type:"circle",source:"places",paint:{"circle-color":"#fff","circle-radius":8,"circle-stroke-width":8,"circle-stroke-color":"#1A5D99"},filter:["==","name",""]});var e=new mapboxgl.NavigationControl({showCompass:!1,showZoom:!0});y.addControl(e,"top-right");var i=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});y.on("mouseenter","places",function(e){y.getCanvas().style.cursor="pointer",y.setFilter("places-hover",["==","name",e.features[0].properties.name]);for(var t=e.features[0].geometry.coordinates.slice(),a=e.features[0].properties.description;180<Math.abs(e.lngLat.lng-t[0]);)t[0]+=e.lngLat.lng>t[0]?360:-360;i.setLngLat(t).setHTML(a).addTo(y)}),y.on("mouseleave","places",function(){y.getCanvas().style.cursor="",y.setFilter("places-hover",["==","name",""]),i.remove()})});var b=[{name:"Наводнение в Свердловской области",date:"14/06/1993",image:"/img/events-detail-01.jpg",dateText:"14 июня 1993 года",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",coordinates:[43.1103,44.3227]},{name:"Прорыв плотины в Башкирии",date:"07/08/1994",image:"/img/events-detail-01.jpg",dateText:"7 августа 1994 года",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",coordinates:[45.1103,46.3227]},{name:"Землятресение на Сахалине",date:"28/05/1995",image:"/img/events-detail-01.jpg",dateText:"28 мая 1995 года",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",coordinates:[47.1103,48.3227]},{name:"Подъем воды в г. Ленск",date:"19/05/1998",image:"/img/events-detail-01.jpg",dateText:"19 мая 1998 года",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",coordinates:[49.1103,50.3227]},{name:"Массовые теракты в России",date:"04/09/1999",image:"/img/events-detail-01.jpg",dateText:"4 сентября 1999 года",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",coordinates:[51.1103,52.3227]}];!function(){if(b.length<2)$(".timeline__line").hide();else if(2<=b.length){function a(e,t,a){var i=t.toLowerCase().split(a),t=e.split(a),e=i.indexOf("mm"),a=i.indexOf("dd"),i=i.indexOf("yyyy"),e=parseInt(t[e]);return--e,new Date(t[i],e,t[a])}b.sort(function(e,t){return a(e.date,"dd/MM/yyyy","/")-a(t.date,"dd/MM/yyyy","/")});for(var t=b[0].date,i=b[b.length-1].date,e=parseInt(t.split("/")[2]),o=parseInt(i.split("/")[2]),r=365*(o+1-e),n=[],s=0;s<=o-e+1;s++){var c=e+s;n.push(c),0}for(var l=0;l<n.length;l++){var d=1,p=1,v=(365*((u=n[l])-e)+30*(p-p)+(d-d))/r;$(".timeline__line-year").append('<div class="year-circle" style="left: '+100*v+'%;"><div class="year-text">'+u+"</div></div>")}for(var m=0;m<n.length-1;m++)for(var d=1,u=n[m],h=1;h<=12;h++){v=(365*(u-e)+30*(h-p)+(d-d))/r;$(".timeline__line-month").append('<div class="month-circle" style="left: '+100*v+'%;"></div>')}for(var f=0;f<b.length;f++){var _=parseInt(b[f].date.split("/")[0]),g=parseInt(b[f].date.split("/")[1]),g=(365*(parseInt(b[f].date.split("/")[2])-e)+30*(g-1)+(_-1))/r,_=g<.2?"t-left":.8<g?"t-right":"";$(".timeline__line-events").append('<div class="events-circle" style="left: '+100*g+'%;" data-coordinates="'+b[f].coordinates+'">  <div class="events-text">'+b[f].name+'</div>  <div class="tooltip tooltip-event '+_+'">\n    <div class="tooltip-event__img">\n      <img src="'+b[f].image+'" alt="">\n    </div>\n    <div class="tooltip-event__info">\n      <div class="tooltip-event__date">'+b[f].dateText+'</div>\n      <div class="tooltip-event__caption">'+b[f].name+'</div>\n      <div class="tooltip-event__description">'+b[f].description+"</div>\n    </div>\n  </div></div>")}}if($(".events-circle:first").addClass("active"),$(".events-circle.active").hasClass("active")){let e=$(".events-circle.active").attr("data-coordinates");t=e.split(",")[0],i=e.split(",")[1];y.jumpTo({center:[t,i]})}}(),$(".events-circle").click(function(){if($(".events-circle").removeClass("active"),$(this).addClass("active"),$(".events-circle.active").hasClass("active")){let e=$(".events-circle.active").attr("data-coordinates");var t=e.split(",")[0],a=e.split(",")[1];y.flyTo({center:[t,a],speed:.5})}});let e=document.querySelector(".timeline__wrapper"),t=document.querySelector(".timeline-prev"),a=document.querySelector(".timeline-next"),i=window.innerWidth,o=e.scrollWidth-i;function r(){0===e.scrollLeft&&e.scrollWidth>i?(t.setAttribute("disabled","disabled"),a.removeAttribute("disabled")):e.scrollLeft>=o&&e.scrollWidth>i||o<0&&e.scrollWidth<i?a.setAttribute("disabled","disabled"):(t.removeAttribute("disabled"),a.removeAttribute("disabled"))}window.addEventListener("resize",function(){i=window.innerWidth,o=e.scrollWidth-i,r()}),e.addEventListener("scroll",r),t.setAttribute("disabled","disabled"),$(".timeline-next").click(function(){event.preventDefault(),$(".timeline__wrapper").animate({scrollLeft:"+=100px"},"slow")}),$(".timeline-prev").click(function(){event.preventDefault(),$(".timeline__wrapper").animate({scrollLeft:"-=100px"},"slow")})});